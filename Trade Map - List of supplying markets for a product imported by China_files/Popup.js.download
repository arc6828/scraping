function MouseMoveEventHandler(){document.getElementById("Div_Popup")!=null&&(document.body.onmousedown=getPositionMouse,document.body.onmousemove=moveMouse,document.body.onmouseup=upMouse)}function getPositionMouse(n){n=n||event;curX=isNaN(n.pageX)?n.x+document.body.scrollLeft:n.pageX;curY=isNaN(n.pageY)?n.y+document.body.scrollTop:n.pageY}function downAction(n,t){n!=null&&n.id=="Div_Popup"&&(isClicked=!0,getPositionMouse(t),gapX=curX-parseInt(n.style.left),gapY=curY-parseInt(n.style.top),changeCursor(document.getElementById("tomove"),t))}function moveMouse(n){var t=document.getElementById("Div_Popup"),i,r;t!=null&&isClicked==!0?(getPositionMouse(n),i=curX-gapX,r=curY-gapY,t.style.left=i+"px",t.style.top=r+"px"):changeCursor(document.getElementById("tomove"),n)}function changeCursor(n){n!=null&&(n.style.cursor="move")}function upMouse(){var n=document.getElementById("Div_Popup");n!=null&&(isClicked=!1)}function getScrollX(){return document.body.scrollLeft||document.documentElement.scrollLeft}function getScrollY(){return document.body.scrollTop||document.documentElement.scrollTop}function ShowPopup(n,t,i,r,u){var f=document.getElementById("Div_Popup"),e,h,c,l,a,o,s;f!=null&&(e="",n=="COMPANY"?(f.style.width="600px",f.style.height="605px",document.getElementById("Iframe_Popup").style.height="95.3%",divMetaWidth=parseInt(f.style.width.substring(0,f.style.width.length-2)),divMetaHeight=parseInt(f.style.height.substring(0,f.style.height.length-2)),maxX=getScrollX()!=0?document.body.clientHeight+getScrollX():window.innerHeight?window.innerWidth:document.documentElement.offsetWidth,h=window.innerWidth?window.innerWidth:document.documentElement.offsetWidth,maxY=getScrollY()!=0?document.body.clientHeight+getScrollY():window.innerHeight?window.innerHeight:document.documentElement.offsetHeight,c=window.innerHeight?window.innerHeight:document.documentElement.offsetHeight,l=187,a=10,700+divMetaWidth<maxX&&(l=700+divMetaWidth<h?(h-divMetaWidth)/2+getScrollX():getScrollX()),20+divMetaHeight<maxY&&(a=20+divMetaHeight<c?(c-divMetaHeight)/2+getScrollY():getScrollY()),f.style.left=l+"px",f.style.top=a+"px",e="./PopupCompany.aspx?compid="+r+"&src="+i):(f.style.width="600px",f.style.height="250px",document.getElementById("Iframe_Popup").style.height="88.5%",divMetaWidth=parseInt(f.style.width.substring(0,f.style.width.length-2)),divMetaHeight=parseInt(f.style.height.substring(0,f.style.height.length-2)),o=curX,s=curY,maxX=document.body.clientWidth+getScrollX(),maxY=document.body.clientHeight+getScrollY(),o+divMetaWidth>maxX&&(o=maxX-divMetaWidth),s+divMetaHeight>maxY&&(s=maxY-divMetaHeight),f.style.left=o+"px",f.style.top=s+"px",e="./PopupMetadata.aspx?type="+n+"&meta="+t+"&column="+i+"&row="+r+"&location="+u),f.style.display="block",f.style.visibility="visible",document.getElementById("Iframe_Popup").setAttribute("src",e))}function HidePopup(){document.getElementById("Div_Popup").style.display="none"}function NewWindowPopup(){var u;document.getElementById("Div_Popup").style.display="none";var n="",t=document.getElementById("Iframe_Popup").getAttribute("src"),i="./PopupMetadata.aspx",r="./PopupCompany.aspx";t.substring(0,i.length)==i?n="./MetadataPage.aspx":t.substring(0,r.length)==r&&(n="./CompanyPage.aspx");n=n+t.substring(t.indexOf("?"),t.length);u=window.open(n,"TradeMap_StandAlone");u.focus()}function SendPrintPopup(){var t=500,i=800,f=(screen.height-t)/2,e=(screen.width-i)/2,n=document.getElementById("Iframe_Popup").getAttribute("src"),r="./PopupMetadata.aspx",u="./PopupCompany.aspx",o;n.substring(0,r.length)==r?newUrl="./MetadataPage.aspx":n.substring(0,u.length)==u&&(newUrl="./CompanyPage.aspx");newUrl=newUrl+n.substring(n.indexOf("?"),n.length)+"&print=yes";o=window.open(newUrl,"","top="+f+",left="+e+",width="+i+",height="+t+",status=no,toolbar=no,menubar=no,location=no,scrollbars=yes")}var curX,curY,isClicked=!1,gapX,gapY